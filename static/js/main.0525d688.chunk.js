(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{29:function(e,t,n){},30:function(e,t,n){},35:function(e,t,n){e.exports=n(51)},40:function(e,t,n){},45:function(e,t,n){},47:function(e,t,n){},50:function(e,t,n){},51:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(22),i=n.n(c),s=n(14),o=(n(40),function(){return r.a.createElement("div",{className:"top-bar my-top-bar"},r.a.createElement("div",{className:"top-bar-left"},r.a.createElement("h3",{className:"top-bar-title"},"\u96a8\u4fbf\u60f3\u5403\u4ec0\u9ebc\uff1f")),r.a.createElement("div",{className:"top-bar-right"},r.a.createElement("ul",{className:"menu"},r.a.createElement("li",null,r.a.createElement(s.c,{to:"/",exact:!0},"\u5403\u4ec0\u9ebc\uff1f")),r.a.createElement("li",null,r.a.createElement(s.c,{to:"/create-rest"},"\u65b0\u589e\u9910\u5ef3")),r.a.createElement("li",null,r.a.createElement(s.c,{to:"/show-all"},"\u9910\u5ef3\u5217\u8868")))))}),l=(n(45),function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(o,null),r.a.createElement("main",{className:"main"},e.children))}),u=n(9),d=n(10),p=n(12),m=n(11),h=n(13),f=n(3),E=n.n(f),b=n(5),v=(n(47),function(e){return r.a.createElement("div",{className:"cell"},r.a.createElement("div",{className:"card card-size"},r.a.createElement("div",{className:"card-section"},r.a.createElement("p",null,"\u540d\u7a31\uff1a",e.name," "),r.a.createElement("p",null,"\u96fb\u8a71\uff1a",e.tel?r.a.createElement("a",{href:"tel:"+e.tel},e.tel):null),r.a.createElement("p",null,"\u5730\u5740\uff1a",e.address," "),r.a.createElement("p",null,"\u985e\u578b\uff1a",e.choices.join(", "))),r.a.createElement("div",{className:"grid-x align-center"},r.a.createElement("div",{className:"small button-group cell small-5"},r.a.createElement("button",{className:"button alert",onClick:function(){return e.onDelete(e.id)}},"\u522a\u9664"),r.a.createElement(s.b,{to:"/edit/"+e.id,className:"button"},"\u7de8\u8f2f")))))}),g=n(15),S=function(e){return JSON.parse(JSON.stringify(e))},O={getCheckedChoices:function(e){return e.reduce(function(e,t){var n=t.data.filter(function(e){return e.checked}).reduce(function(e,t){return[].concat(Object(g.a)(e),[t.label])},[]);return[].concat(Object(g.a)(e),Object(g.a)(n))},[])}},I=n(1),y=n(19),L=n.n(y),T=!1,j=[{id:L()(),name:"\u9ea5\u7576\u52de",tel:"",choices:["\u4fbf\u5b9c","\u901f\u98df","\u5783\u573e\u98df\u7269","\u5168\u5929","\u6709\u5916\u5e36"]},{id:L()(),name:"test2 \u9910\u5ef3",address:"\u6e2c\u8a66\u7684\u5730\u5740\u8981\u5f88\u9577\u6e2c\u8a66\u7684\u5730\u5740\u8981\u5f88\u9577",choices:[]},{id:L()(),name:"test333333333333 \u9910\u5ef3",choices:[]}],C=function(e){try{var t=localStorage.getItem(e);return t&&JSON.parse(t)}catch(n){console.error(n),alert("\u767c\u751f\u932f\u8aa4\u4e86\uff01please reload the page!"),R("MY-REST-LIST",j)}return""},R=function(e,t){localStorage.setItem(e,JSON.stringify(t))},N=function(e){!function(){T||(C("INIT_STORE_ID")||(R("INIT_STORE_ID",!0),R("MY-REST-LIST",j)),T=!0)}(),setTimeout(function(){var t=C("MY-REST-LIST");e(Array.isArray(t)?t:[])},1e3)},_=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){};return function(t){t(V(!0)),N(function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];e(n),t(V(!1))})}},k=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};return function(n){n(V(!0)),function(e,t){setTimeout(function(){R("MY-REST-LIST",e),t()},1e3)}(e,function(){n(V(!1)),t()})}},w=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};return function(a,r){return a(P(function(){a(e),t&&a(k(r().restaurantList.restList)),n()}))}},M=function(e,t,n){return w(e,!0,n)},x=function(){return{type:"RESET_ALL_CHOICES"}},P=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){};return function(t){return t(_(function(n){t(function(e){return{type:"SET_REST_LIST",list:e}}(n)),e()}))}},D=function(e){return{type:"MAP_CHOICES_INPUTS",rest:e}},A=function(e){return w({type:"FILTER_REST_LIST",choices:e})},V=function(e){return{type:"SET_LOADING",isLoading:e}},F=function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){this.props.dispatch(P())}},{key:"randomSelectRest",value:function(e){var t=this.props.restList.length,n=this.props.restList;return!e||t<=e?n:function(){for(var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,n=arguments.length>1?arguments[1]:void 0,a=[],r=0;r<t;){var c=(e=n,Math.floor(Math.random()*Math.floor(e)));a.includes(c)||(a.push(c),r++)}return console.log("list",a),a}(e,t).map(function(e){return n[e]})}},{key:"render",value:function(){var e=this,t=null,n=this.randomSelectRest(this.props.displayNum),a=function(t){e.props.dispatch(function(e){return function(t,n){return t({type:"DELETE_REST",id:e}),t(k(n().restaurantList.restList))}}(t))};return t=n.length?n.map(function(e){return r.a.createElement(v,Object.assign({key:e.id},e,{onDelete:a}))}):this.props.isLoading?r.a.createElement("p",null,"Loading..."):r.a.createElement("p",null,"\u5f88\u62b1\u6b49\uff0c\u76ee\u524d\u6c92\u6709\u9069\u5408\u7684\u9910\u5ef3\u5594\uff01"),r.a.createElement("div",{className:"grid-container"},r.a.createElement("div",{className:"grid-x grid-padding-x small-up-1 medium-up-2 large-up-3"},t))}}]),t}(a.Component);F.propsType={restList:E.a.array.isRequired,isLoading:E.a.bool,displayNum:E.a.number};var H=Object(b.b)(function(e){return{restList:e.restaurantList.restList,isLoading:e.restaurantList.isLoading}},function(e){return{dispatch:e}})(F),J=(n(29),function(e){var t=e.list.map(function(t,n){var a=e.type+"_checkbox_"+n;return r.a.createElement(r.a.Fragment,{key:n},r.a.createElement("input",{id:a,type:"checkbox",checked:t.checked,onChange:function(){return e.onChange(e.type,n)}}),r.a.createElement("label",{className:"button",htmlFor:a},t.label))});return r.a.createElement("div",{className:"grid-x grid-padding-x panel-select"},r.a.createElement("div",{className:"cell"},r.a.createElement("label",null,e.label),t))}),U=function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(p.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).handleChoiceSelectorChange=function(e,t){var a=n.props.choices.map(function(n){if(n.type===e){var a=n.data.map(function(e,n){return t!==n?e:Object(I.a)({},e,{checked:!e.checked})});return Object(I.a)({},n,{data:a})}return n});n.props.setChoices(a)},n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",null,this.props.choices.map(function(t,n){return r.a.createElement(J,{key:n,type:t.type,list:t.data,onChange:e.handleChoiceSelectorChange,label:t.label})}))}}]),t}(a.Component),q=Object(b.b)(function(e){return{choices:e.choicesPanel.choices}},function(e){return{setChoices:function(t){e(function(e){return{type:"SET_CHOICES",choices:e}}(t))}}})(U),Y=function(e){var t="res_"+e.id;return r.a.createElement("div",{className:"cell"},r.a.createElement("label",{htmlFor:t},e.label,e.isValid?null:r.a.createElement("span",{className:"form-error show"},e.inputProps.errorMessage)),r.a.createElement("input",{type:e.inputProps.type,name:t,id:t,value:e.value,onChange:function(t){return e.onChange(t,e.id)},placeholder:e.inputProps.placeholder}))},W=function(e){return r.a.createElement("div",{className:"grid-x grid-padding-x"},Object.keys(e.restInfo).map(function(t,n){var a=Object(I.a)({},e.restInfo[t],{id:t});return r.a.createElement(Y,Object.assign({key:n},a,{onChange:e.onChange}))}))},G=function(e){return r.a.createElement("div",{className:"grid-x grid-padding-x align-center submit-button"},r.a.createElement("fieldset",{className:"cell"},r.a.createElement("button",{className:"button small expanded",type:"submit",value:"Submit",onClick:function(){e.onClick&&e.onClick()},disabled:e.disabled},"\u9001\u51fa")))},B=(n(30),function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(p.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).handleInfoChange=function(e,t){var a=Object(I.a)({},n.props.restInfo),r=e.target.value,c=n.validateInput(r,a[t]);a[t]=Object(I.a)({},a[t],{value:r,isValid:c}),n.props.setRestInfo(a)},n.validateInput=function(e,t){var n=!0,a=e.trim();return t.isRequired&&(n=""!==a),"tel"===t.inputProps.type&&(n=!isNaN(parseFloat(a))&&isFinite(a)||""===a),n},n.isValidToSubmit=function(){return Object.keys(n.props.restInfo).reduce(function(e,t){return n.props.restInfo[t].isValid&&e},!0)},n.handleSubmit=function(e){if(e.preventDefault(),n.isValidToSubmit()){var t={name:n.props.restInfo.name.value,tel:n.props.restInfo.tel.value,address:n.props.restInfo.address.value,choices:O.getCheckedChoices(n.props.choices)};n.props.match.params.id?n.props.handleEditRest(n.props.match.params.id,t,n.props.history):n.props.handleCreateRest(t,n.props.history),n.props.resetChoicesAndRestInfo()}else alert("\u8cc7\u6599\u6709\u8aa4\uff01\u4e0d\u80fd\u65b0\u589e\uff01")},n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"componentWillMount",value:function(){var e;this.props.match.params.id&&this.props.dispatch((e=this.props.match.params.id,function(t){return t(_(function(n){var a=n.find(function(t){return t.id===e});t(D(a))}))}))}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"main-selector-panel"},r.a.createElement("form",{onSubmit:function(t){return e.handleSubmit(t)}},r.a.createElement(W,{restInfo:this.props.restInfo,onChange:this.handleInfoChange}),r.a.createElement(q,null),r.a.createElement(G,{disabled:!this.isValidToSubmit()})))}}]),t}(a.Component)),z=Object(b.b)(function(e){return{choices:e.choicesPanel.choices,restInfo:e.choicesPanel.restInfo}},function(e){return{handleCreateRest:function(t,n){e(function(e,t){return M({type:"ADD_REST",rest:Object(I.a)({},e,{id:L()()})})}(t))},handleEditRest:function(t,n,a){e(function(e,t,n){return M({type:"EDIT_REST",rest:Object(I.a)({},t,{id:e})})}(t,n))},setRestInfo:function(t){e({type:"SET_REST_INPUT_VALUES",restInfo:t})},resetChoicesAndRestInfo:function(){e(x())},dispatch:e}})(B),$=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(p.a)(this,Object(m.a)(t).call(this,e))).handleSubmit=function(e){e.preventDefault();var t=O.getCheckedChoices(n.props.choices);0!==t.length?(n.props.dispatch(A(t)),n.props.dispatch(x()),n.setState({isSelectRest:!0})):n.setState({isSelectRest:!1,restId:Math.random()}),window.scrollTo(0,0)},n.state={isSelectRest:!1,restId:Math.random()},n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"componentWillMount",value:function(){this.props.dispatch(P())}},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement("form",{onSubmit:function(t){return e.handleSubmit(t)}},r.a.createElement("div",null,r.a.createElement("span",null,this.state.isSelectRest?"\u7be9\u9078\u7d50\u679c":"\u96a8\u4fbf\u6311\u4e09\u500b\u7d66\u4f60","\uff1a"),r.a.createElement("div",null,r.a.createElement(H,{displayNum:3,id:this.state.restId}))),r.a.createElement("div",null,"\u6216\u662f\u5728\u4e0b\u9762\u7be9\u9078\uff1a\uff08\u7121\u7be9\u9078=\u96a8\u6a5f\u518d\u9078\u64c7\uff09"),r.a.createElement("div",{className:"main-selector-panel"},r.a.createElement(q,null),r.a.createElement(G,null))))}}]),t}(a.Component),K=Object(b.b)(function(e){return{restList:e.restaurantList.restList,choices:e.choicesPanel.choices}},function(e){return{dispatch:e}})($),Q=n(16);n(50);var X=Object(b.b)(function(e){return{isLoading:e.restaurantList.isLoading}})(function(e){return r.a.createElement(s.a,null,r.a.createElement("div",null,r.a.createElement(l,null,r.a.createElement(Q.a,{path:"/",exact:!0,component:K}),r.a.createElement(Q.a,{path:"/show-all",exact:!0,component:H}),r.a.createElement(Q.a,{path:"/create-rest",exact:!0,component:z}),r.a.createElement(Q.a,{path:"/edit/:id",exact:!0,component:z}))),r.a.createElement("div",{className:"is-loading "+(e.isLoading&&"is-visible")},r.a.createElement("div",{className:"sp sp-circle"})))});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Z=n(17),ee=n(33),te=n(34),ne=n.n(te),ae=function(e){return e.map(function(e){return{label:e,checked:!1}})},re={choices:[{type:"RES_PRICE",label:"\u50f9\u683c",data:ae(["\u4fbf\u5b9c","\u9084\u53ef\u4ee5","\u8cb4"])},{type:"RES_STYLE",label:"\u98a8\u683c",data:ae(["\u4e2d\u5f0f","\u706b\u934b","\u897f\u5f0f","\u65e5\u5f0f","\u7570\u570b\u6599\u7406","\u4fbf\u7576","\u9eb5\u5e97","\u901f\u98df","\u7d20\u98df","\u5c0f\u5403","\u65e9\u9910\u5e97","\u5783\u573e\u98df\u7269"])},{type:"RES_TIME",label:"\u6642\u9593",data:ae(["\u5168\u5929","\u65e9\u9910","\u4e2d\u9910","\u665a\u9910","\u5bb5\u591c"])},{type:"RES_MODE",label:"\u5fc3\u60c5",data:ae(["\u6709\u6e6f","\u7121\u6e6f","\u5929\u6c23\u71b1\u60f3\u5403","\u5929\u6c23\u51b7\u60f3\u5403","\u6709\u670d\u52d9\u8cbb","\u7121\u670d\u52d9\u8cbb","\u805a\u9910","\u6709\u9152","\u6709\u5916\u5e36"])}],restInfo:{name:{value:"",label:"*\u540d\u7a31",inputProps:{type:"text",placeholder:"\u8acb\u8f38\u5165\u9910\u5ef3\u540d\u7a31...",errorMessage:"\u6b64\u6b04\u4f4d\u70ba\u5fc5\u586b"},isValid:!1,isRequired:!0,showInCreationMode:!0},tel:{value:"",label:"\u96fb\u8a71",inputProps:{type:"tel",placeholder:"\u8acb\u8f38\u5165\u9910\u5ef3\u96fb\u8a71...",errorMessage:"\u6b64\u6b04\u4f4d\u5fc5\u9808\u70ba\u6578\u5b57"},isValid:!0,isRequired:!1,showInCreationMode:!1},address:{value:"",label:"\u5730\u5740",inputProps:{type:"text",placeholder:"\u8acb\u8f38\u5165\u9910\u5ef3\u5730\u5740..."},isValid:!0,isRequired:!1,showInCreationMode:!1}}},ce=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Object(g.a)(S(re.choices)).map(function(t){var n=t.data.map(function(t){return t.checked=e.includes(t.label),Object(I.a)({},t)});return Object(I.a)({},t,{data:n})})},ie=function(e){var t=Object(I.a)({},S(re.restInfo));return t.name.value=e.name||"",t.name.isValid=!0,t.tel.value=e.tel||"",t.address.value=e.address||"",t},se={isLoading:!1,restList:[]},oe=function(e){return{id:e.id,name:e.name,tel:e.tel,address:e.address,choices:e.choices}},le=Object(Z.c)({choicesPanel:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:re,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_CHOICES":return Object(I.a)({},e,{choices:t.choices});case"SET_REST_INPUT_VALUES":return Object(I.a)({},e,{restInfo:t.restInfo});case"RESET_ALL_CHOICES":return Object(I.a)({},S(re));case"MAP_CHOICES_INPUTS":return{restInfo:ie(t.rest),choices:ce(t.rest.choices)};default:return e}},restaurantList:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:se,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_REST":return Object(I.a)({},e,{restList:[].concat(Object(g.a)(e.restList),[oe(t.rest)])});case"EDIT_REST":return Object(I.a)({},e,{restList:e.restList.map(function(e){return t.rest.id===e.id?oe(t.rest):e})});case"DELETE_REST":return Object(I.a)({},e,{restList:e.restList.filter(function(e){return e.id!==t.id})});case"GET_REST_LIST":return e;case"SET_REST_LIST":return Object(I.a)({},e,{restList:t.list});case"FILTER_REST_LIST":return Object(I.a)({},e,{restList:e.restList.filter(function(e){return e.choices.reduce(function(e,n){return e||t.choices.includes(n)},!1)})});case"SET_LOADING":return Object(I.a)({},e,{isLoading:t.isLoading});default:return e}}}),ue=function(e){return Object(Z.d)(le,e,Object(Z.a)(ee.a,ne.a))}();i.a.render(r.a.createElement(b.a,{store:ue},r.a.createElement(X,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[35,1,2]]]);
//# sourceMappingURL=main.0525d688.chunk.js.map